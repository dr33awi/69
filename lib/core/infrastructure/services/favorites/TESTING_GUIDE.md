# Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„Ø¬ÙˆØ¯Ø© - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø© Ø§Ù„Ù…ÙˆØ­Ø¯

## ğŸ§ª Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø© Ø§Ù„Ù…ÙˆØ­Ø¯ ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¬ÙˆØ¯ØªÙ‡ ÙˆÙ…ÙˆØ«ÙˆÙ‚ÙŠØªÙ‡. ÙŠØªØ¶Ù…Ù† Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø©ØŒ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ØŒ ÙˆØ§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡.

## ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### âœ… Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©
- [ ] Ø¥Ø¶Ø§ÙØ© ÙˆØ¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª
- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©
- [ ] Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø©
- [ ] Ø§Ù„ØªØ±ØªÙŠØ¨ ÙˆØ§Ù„ØªØµÙ†ÙŠÙ
- [ ] Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±

### âœ… Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„
- [ ] Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ StorageService
- [ ] Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Service Locator
- [ ] ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
- [ ] Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªØºÙŠÙŠØ±

### âœ… Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
- [ ] Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
- [ ] Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
- [ ] ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¨Ø­Ø«
- [ ] Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª

### âœ… Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- [ ] Ø§Ù„ØªØ±Ø­ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
- [ ] Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
- [ ] Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

## ğŸ”§ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### 1. Ø¥Ø¶Ø§ÙØ© dependencies Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

ÙÙŠ `pubspec.yaml`:
```yaml
dev_dependencies:
  flutter_test:
    sdk: flutter
  mockito: ^5.4.2
  build_runner: ^2.4.6
  mocktail: ^0.3.0
  fake_async: ^1.3.1
  test: ^1.21.0
```

### 2. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª

```
test/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ favorites_service_test.dart
â”‚   â”œâ”€â”€ favorite_models_test.dart
â”‚   â””â”€â”€ favorites_extensions_test.dart
â”œâ”€â”€ widget/
â”‚   â”œâ”€â”€ favorite_button_test.dart
â”‚   â””â”€â”€ unified_favorites_screen_test.dart
â”œâ”€â”€ integration/
â”‚   â”œâ”€â”€ favorites_integration_test.dart
â”‚   â””â”€â”€ migration_test.dart
â””â”€â”€ mocks/
    â”œâ”€â”€ mock_storage_service.dart
    â””â”€â”€ test_data.dart
```

## ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø© (Unit Tests)

### Ø§Ø®ØªØ¨Ø§Ø± FavoritesService

```dart
// test/unit/favorites_service_test.dart
import 'package:flutter_test/flutter_test.dart';
import 'package:mockito/mockito.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/favorites_service.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/models/favorite_models.dart';

import '../mocks/mock_storage_service.dart';

class MockStorageService extends Mock implements StorageService {}

void main() {
  group('FavoritesService', () {
    late FavoritesService favoritesService;
    late MockStorageService mockStorageService;

    setUp(() {
      mockStorageService = MockStorageService();
      favoritesService = FavoritesService();
      // Ø­Ù‚Ù† Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ù…Ø²ÙŠÙ
      // favoritesService.storageService = mockStorageService;
    });

    group('Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª', () {
      test('ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­', () async {
        // Ø¥Ø¹Ø¯Ø§Ø¯
        final testItem = FavoriteItem.fromDua(
          duaId: 'test_dua_001',
          title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
          arabicText: 'Ù†Øµ Ø§Ù„Ø¯Ø¹Ø§Ø¡ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±',
        );

        when(mockStorageService.getString(any)).thenReturn(null);
        when(mockStorageService.setString(any, any)).thenAnswer((_) async => true);

        // ØªÙ†ÙÙŠØ°
        final result = await favoritesService.addFavorite(testItem);

        // ØªØ­Ù‚Ù‚
        expect(result, isTrue);
        verify(mockStorageService.setString(any, any)).called(1);
      });

      test('ÙŠØ¬Ø¨ Ø±ÙØ¶ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ù…ÙƒØ±Ø±', () async {
        // Ø¥Ø¹Ø¯Ø§Ø¯
        final testItem = FavoriteItem.fromDua(
          duaId: 'existing_dua',
          title: 'Ø¯Ø¹Ø§Ø¡ Ù…ÙˆØ¬ÙˆØ¯',
          arabicText: 'Ù†Øµ Ù…ÙˆØ¬ÙˆØ¯',
        );

        // Ù…Ø­Ø§ÙƒØ§Ø© ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø³Ø¨Ù‚Ø§Ù‹
        when(mockStorageService.getString(any))
            .thenReturn('{"existing_dua": {...}}');

        // ØªÙ†ÙÙŠØ°
        final result = await favoritesService.addFavorite(testItem);

        // ØªØ­Ù‚Ù‚
        expect(result, isFalse);
      });

      test('ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ù…ÙØ¶Ù„Ø§Øª', () async {
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ù…Ù…ØªÙ„Ø¦Ø©
        final favorites = List.generate(1000, (index) => 
          FavoriteItem.fromDua(
            duaId: 'dua_$index',
            title: 'Ø¯Ø¹Ø§Ø¡ $index',
            arabicText: 'Ù†Øµ $index',
          )
        );

        // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
        when(mockStorageService.getString(any))
            .thenReturn(jsonEncode(favorites.map((f) => f.toMap()).toList()));

        final newItem = FavoriteItem.fromDua(
          duaId: 'dua_1001',
          title: 'Ø¯Ø¹Ø§Ø¡ Ø¬Ø¯ÙŠØ¯',
          arabicText: 'Ù†Øµ Ø¬Ø¯ÙŠØ¯',
        );

        // ØªÙ†ÙÙŠØ°
        expect(
          () => favoritesService.addFavorite(newItem),
          throwsA(isA<FavoritesException>()),
        );
      });
    });

    group('Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª', () {
      test('ÙŠØ¬Ø¨ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØµØ­ÙŠØ­Ø©', () async {
        // Ø¥Ø¹Ø¯Ø§Ø¯
        final testItems = [
          FavoriteItem.fromDua(
            duaId: 'dua_001',
            title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø§Ø³ØªØ®Ø§Ø±Ø©',
            arabicText: 'Ø§Ù„Ù„Ù‡Ù… Ø¥Ù†ÙŠ Ø£Ø³ØªØ®ÙŠØ±Ùƒ Ø¨Ø¹Ù„Ù…Ùƒ',
          ),
          FavoriteItem.fromDua(
            duaId: 'dua_002',
            title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø³ÙØ±',
            arabicText: 'Ø§Ù„Ù„Ù‡Ù… Ø£Ù†Øª Ø§Ù„ØµØ§Ø­Ø¨ ÙÙŠ Ø§Ù„Ø³ÙØ±',
          ),
        ];

        when(mockStorageService.getString(any))
            .thenReturn(jsonEncode(testItems.map((f) => f.toMap()).toList()));

        await favoritesService.initialize();

        // ØªÙ†ÙÙŠØ°
        final results = await favoritesService.searchFavorites('Ø§Ù„Ø§Ø³ØªØ®Ø§Ø±Ø©');

        // ØªØ­Ù‚Ù‚
        expect(results.length, equals(1));
        expect(results.first.title, contains('Ø§Ù„Ø§Ø³ØªØ®Ø§Ø±Ø©'));
      });

      test('ÙŠØ¬Ø¨ ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø©', () async {
        // Ø¥Ø¹Ø¯Ø§Ø¯
        final testItems = [
          FavoriteItem.fromDua(
            duaId: 'dua_001',
            title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ù†ÙˆÙ…',
            arabicText: 'Ø§Ù„Ù„Ù‡Ù… Ø¨Ø§Ø³Ù…Ùƒ Ø£Ù…ÙˆØª ÙˆØ£Ø­ÙŠØ§',
          ),
          FavoriteItem.fromDua(
            duaId: 'dua_002',
            title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø§Ø³ØªÙŠÙ‚Ø§Ø¸ Ù…Ù† Ø§Ù„Ù†ÙˆÙ…',
            arabicText: 'Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ Ø§Ù„Ø°ÙŠ Ø£Ø­ÙŠØ§Ù†Ø§ Ø¨Ø¹Ø¯ Ù…Ø§ Ø£Ù…Ø§ØªÙ†Ø§',
          ),
        ];

        when(mockStorageService.getString(any))
            .thenReturn(jsonEncode(testItems.map((f) => f.toMap()).toList()));

        await favoritesService.initialize();

        // ØªÙ†ÙÙŠØ°
        final results = await favoritesService.searchFavorites('Ø§Ù„Ù†ÙˆÙ…');

        // ØªØ­Ù‚Ù‚ - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† "Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ù†ÙˆÙ…" Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø£Ù† "Ø§Ù„Ù†ÙˆÙ…" ÙÙŠ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        expect(results.length, equals(2));
        expect(results.first.title, equals('Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ù†ÙˆÙ…'));
      });
    });

    group('Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª', () {
      test('ÙŠØ¬Ø¨ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©', () async {
        // Ø¥Ø¹Ø¯Ø§Ø¯
        final testItems = [
          FavoriteItem.fromDua(duaId: 'dua_001', title: 'Ø¯Ø¹Ø§Ø¡ 1', arabicText: 'Ù†Øµ'),
          FavoriteItem.fromAthkar(athkarId: 'athkar_001', text: 'Ø°ÙƒØ± 1'),
          FavoriteItem.fromAsmaAllah(nameId: 'name_001', arabicName: 'Ø§Ù„Ù„Ù‡', transliteration: 'Allah', meaning: 'God'),
        ];

        when(mockStorageService.getString(any))
            .thenReturn(jsonEncode(testItems.map((f) => f.toMap()).toList()));

        await favoritesService.initialize();

        // ØªÙ†ÙÙŠØ°
        final stats = await favoritesService.getStatistics();

        // ØªØ­Ù‚Ù‚
        expect(stats.totalCount, equals(3));
        expect(stats.countByType[FavoriteContentType.dua], equals(1));
        expect(stats.countByType[FavoriteContentType.athkar], equals(1));
        expect(stats.countByType[FavoriteContentType.asmaAllah], equals(1));
      });
    });
  });
}
```

### Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù…Ø§Ø°Ø¬

```dart
// test/unit/favorite_models_test.dart
import 'dart:convert';
import 'package:flutter_test/flutter_test.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/models/favorite_models.dart';

void main() {
  group('FavoriteItem', () {
    test('ÙŠØ¬Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ø¯Ø¹Ø§Ø¡ ØµØ­ÙŠØ­', () {
      final item = FavoriteItem.fromDua(
        duaId: 'test_001',
        title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
        arabicText: 'Ù†Øµ Ø¹Ø±Ø¨ÙŠ',
        translation: 'English text',
      );

      expect(item.id, equals('test_001'));
      expect(item.title, equals('Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±'));
      expect(item.contentType, equals(FavoriteContentType.dua));
      expect(item.metadata['translation'], equals('English text'));
    });

    test('ÙŠØ¬Ø¨ ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ JSON ÙˆØ§Ù„Ø¹ÙƒØ³', () {
      final originalItem = FavoriteItem.fromDua(
        duaId: 'test_002',
        title: 'Ø¯Ø¹Ø§Ø¡ JSON',
        arabicText: 'Ù†Øµ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±',
      );

      // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ JSON
      final jsonString = originalItem.toJson();
      expect(jsonString, isA<String>());

      // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù…Ù† JSON
      final restoredItem = FavoriteItem.fromJson(jsonString);
      expect(restoredItem.id, equals(originalItem.id));
      expect(restoredItem.title, equals(originalItem.title));
      expect(restoredItem.contentType, equals(originalItem.contentType));
    });

    test('ÙŠØ¬Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© Ø¨Ø£Ù…Ø§Ù†', () {
      final item = FavoriteItem.fromDua(
        duaId: 'minimal_test',
        title: 'Ø­Ø¯ Ø£Ø¯Ù†Ù‰',
        arabicText: 'Ù†Øµ',
        // Ø¨Ø¯ÙˆÙ† translation Ø£Ùˆ virtue
      );

      expect(item.metadata['translation'], isNull);
      expect(item.metadata['virtue'], isNull);
      
      // ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡
      final jsonString = item.toJson();
      final restored = FavoriteItem.fromJson(jsonString);
      expect(restored.id, equals('minimal_test'));
    });
  });

  group('FavoritesStatistics', () {
    test('ÙŠØ¬Ø¨ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©', () {
      final countByType = {
        FavoriteContentType.dua: 5,
        FavoriteContentType.athkar: 3,
        FavoriteContentType.asmaAllah: 2,
      };

      final stats = FavoritesStatistics(
        totalCount: 10,
        countByType: countByType,
        lastUpdated: DateTime.now(),
      );

      expect(stats.totalCount, equals(10));
      expect(stats.countByType.length, equals(3));
      expect(stats.mostPopularType, equals(FavoriteContentType.dua));
    });

    test('ÙŠØ¬Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„ÙØ§Ø±ØºØ©', () {
      final stats = FavoritesStatistics(
        totalCount: 0,
        countByType: {},
        lastUpdated: DateTime.now(),
      );

      expect(stats.totalCount, equals(0));
      expect(stats.mostPopularType, isNull);
    });
  });
}
```

## ğŸ¨ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (Widget Tests)

### Ø§Ø®ØªØ¨Ø§Ø± FavoriteButton

```dart
// test/widget/favorite_button_test.dart
import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:mockito/mockito.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/widgets/favorite_button.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/models/favorite_models.dart';

class MockFavoritesService extends Mock implements FavoritesService {}

void main() {
  group('FavoriteButton Widget', () {
    late MockFavoritesService mockService;

    setUp(() {
      mockService = MockFavoritesService();
    });

    testWidgets('ÙŠØ¬Ø¨ Ø¹Ø±Ø¶ Ø£ÙŠÙ‚ÙˆÙ†Ø© ØµØ­ÙŠØ­Ø© Ù„Ù„Ù…ÙØ¶Ù„Ø©', (WidgetTester tester) async {
      // Ø¥Ø¹Ø¯Ø§Ø¯
      final testItem = FavoriteItem.fromDua(
        duaId: 'test_001',
        title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
        arabicText: 'Ù†Øµ',
      );

      when(mockService.isFavorite('test_001')).thenAnswer((_) async => true);

      // Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      await tester.pumpWidget(
        MaterialApp(
          home: Scaffold(
            body: FavoriteButton(
              itemId: 'test_001',
              favoriteItem: testItem,
            ),
          ),
        ),
      );

      // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©
      await tester.pumpAndSettle();

      // ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©
      expect(find.byIcon(Icons.favorite), findsOneWidget);
    });

    testWidgets('ÙŠØ¬Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±', (WidgetTester tester) async {
      // Ø¥Ø¹Ø¯Ø§Ø¯
      final testItem = FavoriteItem.fromDua(
        duaId: 'test_002',
        title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„ØªØºÙŠÙŠØ±',
        arabicText: 'Ù†Øµ',
      );

      when(mockService.isFavorite('test_002')).thenAnswer((_) async => false);
      when(mockService.toggleFavorite(testItem)).thenAnswer((_) async => true);

      // Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      await tester.pumpWidget(
        MaterialApp(
          home: Scaffold(
            body: FavoriteButton(
              itemId: 'test_002',
              favoriteItem: testItem,
            ),
          ),
        ),
      );

      await tester.pumpAndSettle();

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©
      expect(find.byIcon(Icons.favorite_border), findsOneWidget);

      // Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
      await tester.tap(find.byType(FavoriteButton));
      await tester.pumpAndSettle();

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©
      verify(mockService.toggleFavorite(testItem)).called(1);
    });

    testWidgets('ÙŠØ¬Ø¨ Ø¹Ø±Ø¶ tooltip ØµØ­ÙŠØ­', (WidgetTester tester) async {
      final testItem = FavoriteItem.fromDua(
        duaId: 'test_003',
        title: 'Ø¯Ø¹Ø§Ø¡ Tooltip',
        arabicText: 'Ù†Øµ',
      );

      when(mockService.isFavorite('test_003')).thenAnswer((_) async => false);

      await tester.pumpWidget(
        MaterialApp(
          home: Scaffold(
            body: FavoriteButton(
              itemId: 'test_003',
              favoriteItem: testItem,
              tooltip: 'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©',
            ),
          ),
        ),
      );

      await tester.pumpAndSettle();

      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Tooltip
      final tooltipFinder = find.byTooltip('Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©');
      expect(tooltipFinder, findsOneWidget);
    });
  });
}
```

### Ø§Ø®ØªØ¨Ø§Ø± UnifiedFavoritesScreen

```dart
// test/widget/unified_favorites_screen_test.dart
import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:mockito/mockito.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/screens/unified_favorites_screen.dart';

void main() {
  group('UnifiedFavoritesScreen Widget', () {
    testWidgets('ÙŠØ¬Ø¨ Ø¹Ø±Ø¶ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©', (WidgetTester tester) async {
      await tester.pumpWidget(
        const MaterialApp(
          home: UnifiedFavoritesScreen(),
        ),
      );

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ TabBar
      expect(find.byType(TabBar), findsOneWidget);
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
      expect(find.text('Ø§Ù„ÙƒÙ„'), findsOneWidget);
      expect(find.text('Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©'), findsOneWidget);
      expect(find.text('Ø§Ù„Ø£Ø°ÙƒØ§Ø±'), findsOneWidget);
      expect(find.text('Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡'), findsOneWidget);
      expect(find.text('Ø§Ù„ØªØ³Ø¨ÙŠØ­'), findsOneWidget);
    });

    testWidgets('ÙŠØ¬Ø¨ Ø¹Ø±Ø¶ Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«', (WidgetTester tester) async {
      await tester.pumpWidget(
        const MaterialApp(
          home: UnifiedFavoritesScreen(),
        ),
      );

      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø­Ù‚Ù„ Ø§Ù„Ù†Øµ
      expect(find.byType(TextField), findsOneWidget);
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Øµ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ
      expect(find.text('Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª...'), findsOneWidget);
    });

    testWidgets('ÙŠØ¬Ø¨ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª', (WidgetTester tester) async {
      await tester.pumpWidget(
        const MaterialApp(
          home: UnifiedFavoritesScreen(),
        ),
      );

      // Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©"
      await tester.tap(find.text('Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©'));
      await tester.pumpAndSettle();

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰
      // (Ù‡Ù†Ø§ Ù†Ø­ØªØ§Ø¬ Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¯Ù‚ÙŠÙ‚)
    });
  });
}
```

## ğŸ”— Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„

### Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ StorageService

```dart
// test/integration/favorites_integration_test.dart
import 'package:flutter_test/flutter_test.dart';
import 'package:integration_test/integration_test.dart';
import 'package:athkar_app/main.dart' as app;
import 'package:athkar_app/app/di/service_locator.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/favorites_service.dart';

void main() {
  IntegrationTestWidgetsFlutterBinding.ensureInitialized();

  group('Favorites Integration Tests', () {
    setUpAll(() async {
      await ServiceLocator.initEssential();
    });

    testWidgets('Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ ÙƒØ§Ù…Ù„: Ø¥Ø¶Ø§ÙØ© ÙˆØ­Ø°Ù ÙˆØ¨Ø­Ø«', (WidgetTester tester) async {
      app.main();
      await tester.pumpAndSettle();

      final favoritesService = getIt<FavoritesService>();
      
      // 1. Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ±
      final testItem = FavoriteItem.fromDua(
        duaId: 'integration_test_001',
        title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒØ§Ù…Ù„',
        arabicText: 'Ù†Øµ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„',
      );

      final added = await favoritesService.addFavorite(testItem);
      expect(added, isTrue);

      // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ¬ÙˆØ¯
      final isFavorite = await favoritesService.isFavorite('integration_test_001');
      expect(isFavorite, isTrue);

      // 3. Ø§Ù„Ø¨Ø­Ø«
      final searchResults = await favoritesService.searchFavorites('Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒØ§Ù…Ù„');
      expect(searchResults.length, greaterThan(0));
      expect(searchResults.any((item) => item.id == 'integration_test_001'), isTrue);

      // 4. Ø§Ù„Ø­Ø°Ù
      final removed = await favoritesService.removeFavorite('integration_test_001');
      expect(removed, isTrue);

      // 5. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø°Ù
      final isStillFavorite = await favoritesService.isFavorite('integration_test_001');
      expect(isStillFavorite, isFalse);
    });

    testWidgets('Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ±Ø­ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ', (WidgetTester tester) async {
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¯ÙŠÙ…Ø© ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
      final storage = getIt<StorageService>();
      
      // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
      await storage.setStringList('dua_favorites', ['old_dua_001', 'old_dua_002']);
      
      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
      final favoritesService = FavoritesService();
      await favoritesService.initialize();
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ±Ø­ÙŠÙ„
      final allFavorites = await favoritesService.getAllFavorites();
      final duaFavorites = allFavorites
          .where((f) => f.contentType == FavoriteContentType.dua)
          .toList();
      
      expect(duaFavorites.length, equals(2));
      expect(duaFavorites.any((f) => f.id == 'old_dua_001'), isTrue);
      expect(duaFavorites.any((f) => f.id == 'old_dua_002'), isTrue);
    });
  });
}
```

## ğŸ“Š Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡

### Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø­Ø«

```dart
// test/performance/search_performance_test.dart
import 'package:flutter_test/flutter_test.dart';
import 'package:athkar_app/core/infrastructure/services/favorites/favorites_service.dart';

void main() {
  group('Performance Tests', () {
    test('ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹Ø§Ù‹ Ù…Ø¹ 1000 Ø¹Ù†ØµØ±', () async {
      final service = FavoritesService();
      
      // Ø¥Ù†Ø´Ø§Ø¡ 1000 Ø¹Ù†ØµØ± ØªØ¬Ø±ÙŠØ¨ÙŠ
      final testItems = List.generate(1000, (index) => 
        FavoriteItem.fromDua(
          duaId: 'perf_test_$index',
          title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø£Ø¯Ø§Ø¡ $index',
          arabicText: 'Ù†Øµ ØªØ¬Ø±ÙŠØ¨ÙŠ Ù„Ù„Ø£Ø¯Ø§Ø¡ Ø±Ù‚Ù… $index',
        )
      );

      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†Ø§ØµØ±
      for (final item in testItems) {
        await service.addFavorite(item);
      }

      // Ù‚ÙŠØ§Ø³ ÙˆÙ‚Øª Ø§Ù„Ø¨Ø­Ø«
      final stopwatch = Stopwatch()..start();
      final results = await service.searchFavorites('Ø§Ù„Ø£Ø¯Ø§Ø¡');
      stopwatch.stop();

      // ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø¨Ø­Ø« Ø£Ø³Ø±Ø¹ Ù…Ù† 100ms
      expect(stopwatch.elapsedMilliseconds, lessThan(100));
      expect(results.length, equals(1000));
    });

    test('ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ØªØ±ØªÙŠØ¨ ÙØ¹Ø§Ù„ Ù…Ø¹ Ø¹Ø¯Ø¯ ÙƒØ¨ÙŠØ±', () async {
      final service = FavoritesService();
      
      // Ø¥Ù†Ø´Ø§Ø¡ 500 Ø¹Ù†ØµØ± Ø¹Ø´ÙˆØ§Ø¦ÙŠ
      final testItems = List.generate(500, (index) => 
        FavoriteItem.fromDua(
          duaId: 'sort_test_$index',
          title: 'Ø¯Ø¹Ø§Ø¡ ${DateTime.now().millisecondsSinceEpoch % 100}',
          arabicText: 'Ù†Øµ Ø¹Ø´ÙˆØ§Ø¦ÙŠ',
        )
      );

      for (final item in testItems) {
        await service.addFavorite(item);
      }

      // Ù‚ÙŠØ§Ø³ ÙˆÙ‚Øª Ø§Ù„ØªØ±ØªÙŠØ¨
      final stopwatch = Stopwatch()..start();
      final sortedResults = await service.getSortedFavorites(
        sortBy: FavoritesSortOptions.alphabetical,
      );
      stopwatch.stop();

      // ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ØªØ±ØªÙŠØ¨ Ø£Ø³Ø±Ø¹ Ù…Ù† 50ms
      expect(stopwatch.elapsedMilliseconds, lessThan(50));
      expect(sortedResults.length, equals(500));
    });
  });
}
```

## ğŸ›¡ï¸ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```dart
// test/security/data_protection_test.dart
import 'package:flutter_test/flutter_test.dart';

void main() {
  group('Data Protection Tests', () {
    test('ÙŠØ¬Ø¨ Ø±ÙØ¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ø§Ù„ØµØ§Ù„Ø­Ø©', () {
      expect(
        () => FavoriteItem.fromDua(
          duaId: '', // Ù…Ø¹Ø±Ù ÙØ§Ø±Øº
          title: 'Ø¯Ø¹Ø§Ø¡',
          arabicText: 'Ù†Øµ',
        ),
        throwsA(isA<ArgumentError>()),
      );
    });

    test('ÙŠØ¬Ø¨ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ØµÙˆØµ Ù…Ù† Ø§Ù„Ù…Ø­Ø§Ø±Ù Ø§Ù„Ø®Ø·Ø±Ø©', () {
      final item = FavoriteItem.fromDua(
        duaId: 'safe_test',
        title: '<script>alert("xss")</script>Ø¯Ø¹Ø§Ø¡ Ø¢Ù…Ù†',
        arabicText: 'Ù†Øµ Ø¢Ù…Ù†',
      );

      // ÙŠØ¬Ø¨ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø®Ø·Ø±Ø©
      expect(item.title, equals('Ø¯Ø¹Ø§Ø¡ Ø¢Ù…Ù†'));
    });

    test('ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø­Ø¬Ù…', () {
      final longText = 'Ø£' * 10000; // Ù†Øµ Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹

      expect(
        () => FavoriteItem.fromDua(
          duaId: 'size_test',
          title: longText,
          arabicText: 'Ù†Øµ',
        ),
        throwsA(isA<ArgumentError>()),
      );
    });
  });
}
```

## ğŸ“‹ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ù…Ù„Ø©

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒØ§Ù…Ù„Ø©

```dart
// test/scenarios/complete_user_journey_test.dart
void main() {
  testWidgets('Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…ÙØ¶Ù„Ø©', (WidgetTester tester) async {
    // 1. ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    app.main();
    await tester.pumpAndSettle();

    // 2. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©
    await tester.tap(find.text('Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©'));
    await tester.pumpAndSettle();

    // 3. Ø§Ø®ØªÙŠØ§Ø± Ø¯Ø¹Ø§Ø¡ ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ù…ÙØ¶Ù„Ø©
    await tester.tap(find.byIcon(Icons.favorite_border).first);
    await tester.pumpAndSettle();

    // 4. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØºÙŠÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
    expect(find.byIcon(Icons.favorite), findsOneWidget);

    // 5. ÙØªØ­ Ø´Ø§Ø´Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©
    await tester.tap(find.byIcon(Icons.bookmark));
    await tester.pumpAndSettle();

    // 6. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù…Ø¶Ø§Ù
    expect(find.byType(ListTile), findsAtLeastNWidgets(1));

    // 7. Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©
    await tester.enterText(find.byType(TextField), 'Ø¯Ø¹Ø§Ø¡');
    await tester.pumpAndSettle();

    // 8. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«
    expect(find.byType(ListTile), findsAtLeastNWidgets(1));

    // 9. Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©
    await tester.tap(find.byIcon(Icons.delete).first);
    await tester.pumpAndSettle();

    // 10. ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù
    await tester.tap(find.text('Ø­Ø°Ù'));
    await tester.pumpAndSettle();

    // 11. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø°Ù
    expect(find.text('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙØ¶Ù„Ø§Øª'), findsOneWidget);
  });
}
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø§Ø®ØªØ¨Ø§Ø± Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø®Ø·Ø£

```dart
void main() {
  group('Error Handling Scenarios', () {
    testWidgets('Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„', (WidgetTester tester) async {
      // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„
      // ÙˆØ§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¹Ù…Ù„ Ø§Ù„Ù…ÙØ¶Ù„Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    });

    testWidgets('Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù…ØªÙ„Ø§Ø¡ Ø§Ù„ØªØ®Ø²ÙŠÙ†', (WidgetTester tester) async {
      // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù…ØªÙ„Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ†
      // ÙˆØ§Ø®ØªØ¨Ø§Ø± Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù…Ù†Ø§Ø³Ø¨Ø©
    });

    testWidgets('Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹Ø·ÙˆØ¨Ø©', (WidgetTester tester) async {
      // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®Ø²Ù†Ø© Ù…Ø¹Ø·ÙˆØ¨Ø©
      // ÙˆØ§Ø®ØªØ¨Ø§Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…
    });
  });
}
```

## ğŸ”§ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### Mock Data Generator

```dart
// test/helpers/test_data_generator.dart
class TestDataGenerator {
  static List<FavoriteItem> generateDuas(int count) {
    return List.generate(count, (index) => 
      FavoriteItem.fromDua(
        duaId: 'test_dua_$index',
        title: 'Ø¯Ø¹Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± $index',
        arabicText: 'Ø§Ù„Ù„Ù‡Ù… Ø§Ø®ØªØ¨Ø§Ø± $index',
        translation: 'Test dua $index',
      )
    );
  }

  static List<FavoriteItem> generateMixedContent(int count) {
    final types = FavoriteContentType.values;
    return List.generate(count, (index) {
      final type = types[index % types.length];
      switch (type) {
        case FavoriteContentType.dua:
          return FavoriteItem.fromDua(
            duaId: 'mixed_dua_$index',
            title: 'Ø¯Ø¹Ø§Ø¡ Ù…Ø®ØªÙ„Ø· $index',
            arabicText: 'Ù†Øµ $index',
          );
        case FavoriteContentType.athkar:
          return FavoriteItem.fromAthkar(
            athkarId: 'mixed_athkar_$index',
            text: 'Ø°ÙƒØ± Ù…Ø®ØªÙ„Ø· $index',
          );
        // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹
        default:
          return generateDuas(1).first;
      }
    });
  }
}
```

### Test Utilities

```dart
// test/helpers/test_utilities.dart
class TestUtilities {
  static Future<void> waitForFavoriteUpdate() async {
    await Future.delayed(Duration(milliseconds: 100));
  }

  static void expectFavoriteInList(List<FavoriteItem> favorites, String itemId) {
    expect(
      favorites.any((item) => item.id == itemId),
      isTrue,
      reason: 'Ø§Ù„Ù…ÙØ¶Ù„Ø© $itemId ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©',
    );
  }

  static void expectFavoriteNotInList(List<FavoriteItem> favorites, String itemId) {
    expect(
      favorites.any((item) => item.id == itemId),
      isFalse,
      reason: 'Ø§Ù„Ù…ÙØ¶Ù„Ø© $itemId Ù…Ø§ Ø²Ø§Ù„Øª Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©',
    );
  }
}
```

## ğŸ“Š ØªÙ‚Ø±ÙŠØ± ØªØºØ·ÙŠØ© Ø§Ù„ÙƒÙˆØ¯

### ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªØºØ·ÙŠØ©

```bash
# ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø¹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØºØ·ÙŠØ©
flutter test --coverage

# Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± HTML
genhtml coverage/lcov.info -o coverage/html

# Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
# Ø§ÙØªØ­ coverage/html/index.html ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
```

### Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØºØ·ÙŠØ©

- **Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø©**: 90%+ ØªØºØ·ÙŠØ©
- **Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©**: 80%+ ØªØºØ·ÙŠØ©  
- **Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„**: 70%+ ØªØºØ·ÙŠØ©
- **Ø§Ù„ØªØºØ·ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©**: 85%+ ØªØºØ·ÙŠØ©

## âœ… Ù‚Ø§Ø¦Ù…Ø© Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬

### Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©
- [ ] Ø¬Ù…ÙŠØ¹ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø© ØªÙ…Ø± Ø¨Ù†Ø¬Ø§Ø­
- [ ] Ø¬Ù…ÙŠØ¹ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ØªÙ…Ø± Ø¨Ù†Ø¬Ø§Ø­
- [ ] Ø¬Ù…ÙŠØ¹ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ ØªÙ…Ø± Ø¨Ù†Ø¬Ø§Ø­
- [ ] Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø¶Ù…Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„Ø©

### Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØºÙŠØ± Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ÙŠØ© (Accessibility)
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù„Ù‰ Ø£Ø¬Ù‡Ø²Ø© Ù…Ø®ØªÙ„ÙØ©
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¹ Ø£Ø­Ø¬Ø§Ù… Ø´Ø§Ø´Ø© Ù…Ø®ØªÙ„ÙØ©

### Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- [ ] Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
- [ ] ÙˆØ¶ÙˆØ­ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
- [ ] Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
- [ ] ØªØµÙ…ÙŠÙ… Ù…ØªØ³Ù‚

### Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ©
- [ ] Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©
- [ ] Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©
- [ ] Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
- [ ] Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙŠØ¶Ù…Ù† Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© ÙˆÙ†Ø¸Ø§Ù… Ù…ÙØ¶Ù„Ø© Ù…ÙˆØ«ÙˆÙ‚ ÙˆØ¢Ù…Ù† Ù„ØªØ·Ø¨ÙŠÙ‚Ùƒ.